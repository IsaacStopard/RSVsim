<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Function to run a Approximate Bayesian Computation (ABC) rejection algorithm — RSVsim_ABC_rejection • RSVsim</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Function to run a Approximate Bayesian Computation (ABC) rejection algorithm — RSVsim_ABC_rejection"><meta name="description" content="Runs the ABC-rejection algorithm."><meta property="og:description" content="Runs the ABC-rejection algorithm."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">RSVsim</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Calibration.html">Calibration</a></li>
    <li><a class="dropdown-item" href="../articles/Introduction.html">Introduction</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/IsaacStopard/RSVsim/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Function to run a Approximate Bayesian Computation (ABC) rejection algorithm</h1>
      <small class="dont-index">Source: <a href="https://github.com/IsaacStopard/RSVsim/blob/master/R/calibration_functions.r" class="external-link"><code>R/calibration_functions.r</code></a></small>
      <div class="d-none name"><code>RSVsim_ABC_rejection.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Runs the ABC-rejection algorithm.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">RSVsim_ABC_rejection</span><span class="op">(</span></span>
<span>  <span class="va">target</span>,</span>
<span>  <span class="va">epsilon</span>,</span>
<span>  <span class="va">summary_fun</span>,</span>
<span>  <span class="va">dist_fun</span>,</span>
<span>  <span class="va">prior_fun</span>,</span>
<span>  <span class="va">n_prior_attempts</span>,</span>
<span>  <span class="va">nparticles</span>,</span>
<span>  <span class="va">used_seeds_all</span>,</span>
<span>  ncores <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="va">fitted_parameter_names</span>,</span>
<span>  <span class="va">fixed_parameter_list</span>,</span>
<span>  times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">365</span> <span class="op">*</span> <span class="fl">5</span>, <span class="fl">0.25</span><span class="op">)</span>,</span>
<span>  cohort_step_size <span class="op">=</span> <span class="fl">0.2</span> <span class="op">*</span> <span class="fl">365</span>,</span>
<span>  init_conds <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  warm_up <span class="op">=</span> <span class="fl">365</span> <span class="op">*</span> <span class="fl">4</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-target">target<a class="anchor" aria-label="anchor" href="#arg-target"></a></dt>
<dd><p>Values to fit to.</p></dd>


<dt id="arg-epsilon">epsilon<a class="anchor" aria-label="anchor" href="#arg-epsilon"></a></dt>
<dd><p>Acceptable error for each target.</p></dd>


<dt id="arg-summary-fun">summary_fun<a class="anchor" aria-label="anchor" href="#arg-summary-fun"></a></dt>
<dd><p>Function to calculate the summary statistics equivalent to the target values.</p></dd>


<dt id="arg-dist-fun">dist_fun<a class="anchor" aria-label="anchor" href="#arg-dist-fun"></a></dt>
<dd><p>Function to the calculate the error between the target and <code>summary_fun</code> outputs.</p></dd>


<dt id="arg-prior-fun">prior_fun<a class="anchor" aria-label="anchor" href="#arg-prior-fun"></a></dt>
<dd><p>Function to sample from the priors for all parameters. Must return a vector.</p></dd>


<dt id="arg-n-prior-attempts">n_prior_attempts<a class="anchor" aria-label="anchor" href="#arg-n-prior-attempts"></a></dt>
<dd><p>Number of random samples from the prior to attempt for each accepted particle.</p></dd>


<dt id="arg-nparticles">nparticles<a class="anchor" aria-label="anchor" href="#arg-nparticles"></a></dt>
<dd><p>Integer. Number of samples from the approximate posterior.</p></dd>


<dt id="arg-used-seeds-all">used_seeds_all<a class="anchor" aria-label="anchor" href="#arg-used-seeds-all"></a></dt>
<dd><p>Vector. Seeds used when generating the prior samples for each accepted particle.</p></dd>


<dt id="arg-ncores">ncores<a class="anchor" aria-label="anchor" href="#arg-ncores"></a></dt>
<dd><p>Number of cores. If greater than one then it is run in parallel.</p></dd>


<dt id="arg-fitted-parameter-names">fitted_parameter_names<a class="anchor" aria-label="anchor" href="#arg-fitted-parameter-names"></a></dt>
<dd><p>Vector of names of the parameters that are being estimated.</p></dd>


<dt id="arg-fixed-parameter-list">fixed_parameter_list<a class="anchor" aria-label="anchor" href="#arg-fixed-parameter-list"></a></dt>
<dd><p>List of parameter values to run the model excluding the fitted parameters.</p></dd>


<dt id="arg-times">times<a class="anchor" aria-label="anchor" href="#arg-times"></a></dt>
<dd><p>Simulation times. Default: 0 - 3650 days with intervals of 0.25 days.</p></dd>


<dt id="arg-cohort-step-size">cohort_step_size<a class="anchor" aria-label="anchor" href="#arg-cohort-step-size"></a></dt>
<dd><p>Time steps to run the model over before adjusting the ages of all cohorts. Default: 10 days.</p></dd>


<dt id="arg-init-conds">init_conds<a class="anchor" aria-label="anchor" href="#arg-init-conds"></a></dt>
<dd><p>Initial conditions to run the model - these are given as prevalence and the initial conditions calculated in this function. List. Default: <code>NULL</code>.
If <code>NULL</code>: 1% RSV prevalence is assumed for people during the primary infection, which is seeded at the beginning of the simulation.
All other people are assumed to be susceptible to their primary infection.</p></dd>


<dt id="arg-warm-up">warm_up<a class="anchor" aria-label="anchor" href="#arg-warm-up"></a></dt>
<dd><p>Length of time-points to exclude before calculating the likelihood. Default: <code>NULL</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>List of fixed parameters, max_t and warm_up.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Isaac Stopard, Alexandra Hogan.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

