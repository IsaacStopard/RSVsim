<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Introduction • RSVsim</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">RSVsim</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Calibration.html">Calibration</a></li>
    <li><a class="dropdown-item" href="../articles/Introduction.html">Introduction</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/IsaacStopard/RSVsim/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Introduction</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/IsaacStopard/RSVsim/blob/master/vignettes/Introduction.Rmd" class="external-link"><code>vignettes/Introduction.Rmd</code></a></small>
      <div class="d-none name"><code>Introduction.Rmd</code></div>
    </div>

    
    
<p>In this vignette, we give an overview of the mathematical model of
RSV transmission and how to use this package to run the model.</p>
<div class="section level2">
<h2 id="model-structure">Model structure<a class="anchor" aria-label="anchor" href="#model-structure"></a>
</h2>
<p>The model is an adapted version of an
susceptible-exposed-infectious-recovered-susceptible (SEIRS)
deterministic, ordinary differential equation (ODE) model outlined
in:</p>
<ul>
<li><p>Hogan, A. B., Campbell, P. T., Blyth, C. C., Lim, F. J., Fathima,
P., Davis, S., … &amp; Glass, K. (2017). Potential impact of a maternal
vaccine for RSV: a mathematical modelling study. Vaccine, 35(45),
6172-6179, <a href="https://doi.org/10.1016/j.vaccine.2017.09.043" class="external-link uri">https://doi.org/10.1016/j.vaccine.2017.09.043</a>,</p></li>
<li><p>Nazareno, A. L., Newall, A. T., Muscatello, D. J., Hogan, A. B.,
&amp; Wood, J. G. (2024). Modelling the epidemiological impact of
maternal respiratory syncytial virus (RSV) vaccination in Australia.
Vaccine, 42(26), 126418, <a href="https://doi.org/10.1016/j.vaccine.2024.126418" class="external-link uri">https://doi.org/10.1016/j.vaccine.2024.126418</a>.</p></li>
</ul>
<p>In brief, the model is age-structured and primary (the first) and
secondary infections (any subsequent infection) are specifically
tracked. The force of infection is determined by a seasonal forcing
function and the age-specific contact matrix (the mean contacts per
person).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/IsaacStopard/RSVsim" class="external-link">RSVsim</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="contact-matrix">Contact matrix<a class="anchor" aria-label="anchor" href="#contact-matrix"></a>
</h2>
<p>The <a href="https://github.com/IsaacStopard/RSVsim/blob/master/R/RSVsim_contact_matrix.R" class="external-link">R/RSVsim_contact_matrix.R</a>
function obtains contact matrices with age groupings that are less than
one year. To do so, the socialmixr (<a href="https://epiforecasts.io/socialmixr/" class="external-link uri">https://epiforecasts.io/socialmixr/</a>) package is used to
obtain the contact matrix for the age groupings to the nearest whole
year, using the POLYMOD data (<a href="https://doi.org/10.1371/journal.pmed.0050074" class="external-link uri">https://doi.org/10.1371/journal.pmed.0050074</a>). This
contact matrix is calculated such that the total contacts in the
population are symmetric (assuming population data from World Population
Prospects of the United Nations). Within age groups less than one year,
these contacts are divided evenly according to the size of the age group
(in years). The function takes two arguments: (1) the country to obtain
the POLYMOD contact data from and (2) the lower age limits of the age
groups.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># specifying the some age limits to use with the model</span></span>
<span><span class="va">age.limits</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">0.2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">60</span>, <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">contact_population_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/RSVsim_contact_matrix.html">RSVsim_contact_matrix</a></span><span class="op">(</span>country <span class="op">=</span> <span class="st">"United Kingdom"</span>, age.limits <span class="op">=</span> <span class="va">age.limits</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="default-parameters">Default parameters<a class="anchor" aria-label="anchor" href="#default-parameters"></a>
</h2>
<p>To obtain a list of the default parameters to run the model use the
<a href="https://github.com/IsaacStopard/RSVsim/blob/master/R/RSVsim_parameters.R" class="external-link">R/RSVsim_parameters.R</a>
function. The parameters can be changed by using the overrides argument;
for example we override
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mn>0</mn></mrow><annotation encoding="application/x-tex">b0</annotation></semantics></math>
(the transmission rate coefficient) with a value of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0.15</mn><annotation encoding="application/x-tex">0.15</annotation></semantics></math>.
The “fitted” argument refers to parameters that will be excluded - the
function will not return any parameters named in this vector. Initial
conditions are defined in the parameter list. If no initial conditions
are given, it is assumed there is 0.1% prevalence in the primary
infection compartment across all ages and everyone else is susceptible
to primary infection. All new-borns are assumed to be in the susceptible
to primary infection compartment.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">parameters</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/RSVsim_parameters.html">RSVsim_parameters</a></span><span class="op">(</span>overrides <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"b0"</span> <span class="op">=</span> <span class="fl">0.15</span><span class="op">)</span>, </span>
<span>                                contact_population_list <span class="op">=</span> <span class="va">contact_population_list</span>,</span>
<span>                                fitted <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="running-the-model">Running the model<a class="anchor" aria-label="anchor" href="#running-the-model"></a>
</h2>
<p>To run the model the <a href="https://github.com/IsaacStopard/RSVsim/blob/master/R/run_model.R" class="external-link">R/RSVsim_run_model.R</a>
function is used. Cohort aging is used to age the population. At each
time, a proportion of each cohort is aged, with this proportion
determined by the length of time before people are aged
(cohort_step_size) as a proportion of the total length of time in each
age group.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/RSVsim_run_model.html">RSVsim_run_model</a></span><span class="op">(</span>parameters <span class="op">=</span> <span class="va">parameters</span>,</span>
<span>                        times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">365</span> <span class="op">*</span> <span class="fl">2</span>, <span class="fl">0.25</span><span class="op">)</span>, <span class="co"># maximum time to run the model for</span></span>
<span>                        cohort_step_size <span class="op">=</span> <span class="fl">60</span>, <span class="co"># time at which to age people\</span></span>
<span>                        warm_up <span class="op">=</span> <span class="fl">365</span><span class="op">)</span></span></code></pre></div>
<p>The simulated number of people that are susceptible and infected,
with the line type indicating whether the infection is primary or
secondary is tracked in the model outputs. The incidence and detected
incidence are calculated. To calculate the detected incidence
age-specific detection probabilities are used, and in the default
parameters we assume very few people (1%) over the age of 2 years old is
tested. The age-specific prevalence is also calculated.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Isaac Stopard, Alexandra Hogan.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
