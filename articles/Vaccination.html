<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Vaccination â€¢ RSVsim</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Vaccination">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">RSVsim</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Calibration.html">Calibration</a></li>
    <li><a class="dropdown-item" href="../articles/Introduction.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/Vaccination.html">Vaccination</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/IsaacStopard/RSVsim/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Vaccination</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/IsaacStopard/RSVsim/blob/master/vignettes/Vaccination.Rmd" class="external-link"><code>vignettes/Vaccination.Rmd</code></a></small>
      <div class="d-none name"><code>Vaccination.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/IsaacStopard/RSVsim" class="external-link">RSVsim</a></span><span class="op">)</span></span></code></pre></div>
<p>In this vignette, we give an overview of how to implement vaccination
in the model. By default, the vaccination coverage is 0 (meaning there
is no vaccination). Vaccination is implemented to those in the S, E and
R states according to a vaccination rate (per person per day). The
number of vaccination states (<code>nVaccStates</code>) must be input in
the model parameters; the minimum number of vaccination states is 2,
which corresponds to unvaccinated (U) and vaccinated (V). Intermediate
vaccination states can also be implemented to account for a delay in
vaccine-derived protection or Erlang vaccination waning time
distributions.</p>
<p><img src="../reference/figures/RSVsim_vaccination.png"></p>
<p>In the example below we show how to implement a single 30-day
vaccination campaign to achieve an approximate coverage of 80% in those
over 70 years old.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># setting up the contact matrix and ages used</span></span>
<span><span class="va">contact_population_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/RSVsim_contact_matrix.html">RSVsim_contact_matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">max_time</span> <span class="op">&lt;-</span> <span class="fl">365.25</span></span>
<span></span>
<span><span class="co"># vaccination times - must include 0 </span></span>
<span><span class="co"># vaccination starts on day 90 and ends on day 120</span></span>
<span><span class="va">vaccine_times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">90</span>, <span class="fl">120</span><span class="op">)</span></span>
<span><span class="va">vaccine_period</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">vaccine_times</span>, <span class="va">max_time</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">nVaccTimes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">vaccine_times</span><span class="op">)</span></span>
<span><span class="va">nAges</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">contact_population_list</span><span class="op">$</span><span class="va">age_limits</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># vaccination coverage</span></span>
<span><span class="co"># set as zero unless in the oldest age group</span></span>
<span><span class="va">vaccine_cov</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="op">(</span><span class="va">nAges</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="va">nVaccTimes</span><span class="op">)</span>, </span>
<span>                            nrow <span class="op">=</span> <span class="op">(</span><span class="va">nAges</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="va">nVaccTimes</span><span class="op">)</span>, </span>
<span>                     <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.80</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># not necessary but included for completeness</span></span>
<span><span class="va">nVaccStates</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span><span class="va">VE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.85</span>, <span class="va">nAges</span> <span class="op">*</span> <span class="op">(</span><span class="va">nVaccStates</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">nAges</span><span class="op">)</span> <span class="co"># vaccine efficacy</span></span>
<span><span class="va">gamma_vaccine</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="fl">365.25</span> <span class="op">*</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># specify the parameters</span></span>
<span><span class="va">parameters</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/RSVsim_parameters.html">RSVsim_parameters</a></span><span class="op">(</span>overrides <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"vaccine_times"</span> <span class="op">=</span> <span class="va">vaccine_times</span>,</span>
<span>                                                 <span class="st">"vaccine_period"</span> <span class="op">=</span> <span class="va">vaccine_period</span>,</span>
<span>                                                 <span class="st">"nVaccTimes"</span> <span class="op">=</span> <span class="va">nVaccTimes</span>,</span>
<span>                                                 <span class="st">"vaccine_cov"</span> <span class="op">=</span> <span class="va">vaccine_cov</span>,</span>
<span>                                                 <span class="st">"nVaccStates"</span> <span class="op">=</span> <span class="va">nVaccStates</span>,</span>
<span>                                                 <span class="st">"VE"</span> <span class="op">=</span> <span class="va">VE</span>,</span>
<span>                                                 <span class="st">"gamma_vaccine"</span> <span class="op">=</span> <span class="va">gamma_vaccine</span></span>
<span>                                                 <span class="op">)</span>,</span>
<span>                                contact_population_list <span class="op">=</span> <span class="va">contact_population_list</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/RSVsim_run_model.html">RSVsim_run_model</a></span><span class="op">(</span>parameters <span class="op">=</span> <span class="va">parameters</span>,</span>
<span>                 times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">max_time</span>, <span class="fl">0.25</span><span class="op">)</span>,</span>
<span>                 cohort_step_size <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">12</span> <span class="op">*</span> <span class="fl">365.25</span>,</span>
<span>                 warm_up <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
<p>The <code>gamma_vaccine</code> parameter must be the length of
<code>nVaccStates - 1</code> and corresponds to the transition rate
between vaccinated states with the final value corresponding to the
transition rate back to the unvaccinated state. Vaccine efficacy
(<code>VE</code>; matrix) is age and vaccine state specific with the
rows corresponding to the age group and the columns corresponding to the
vaccinated state. To implement vaccination we must specify the times at
which vaccination coverage changes (<code>vaccine_times</code>; vector
of length <code>nVaccTimes</code>) and the approximate coverage at each
vaccination distribution time (<code>vaccine_cov</code>; matrix: rows
correspond to each age group and columns correspond to the vaccination
time). The vaccination rate between each time is assumed to be constant
and calculated to give the <code>vaccine_cov</code> value at the time
when the vaccine coverage changes. To do so, the
<code>vaccine_period</code> corresponding to the difference in times
between the vaccination times is given. The vaccination rate is then
calculated in the model thus,
<code>-log(1 - vaccine_cov[i,j]) / vaccine_period[j]</code>, which
assumes no vaccine waning and the effective vaccination coverage should
be calculated from the model outputs. The number of doses administered
are given as a default model output.</p>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Isaac Stopard, Alexandra Hogan.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
