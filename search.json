[{"path":"https://isaacstopard.github.io/RSVsim/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2025 RSVsim authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://isaacstopard.github.io/RSVsim/articles/Calibration.html","id":"simulating-some-synthetic-data","dir":"Articles","previous_headings":"","what":"Simulating some synthetic data","title":"Calibration","text":"begin simulating data using R/run_model.R function, , arbitrarily select b0 value 0.15, b1 value 0.25 phi value 10 days. add noise count data drawing random samples negative binomial distribution greater variance poisson distribution mean equivalent simulated incidence values.","code":"# getting the model parameters age.limits <- c(seq(0, 5, 1), seq(10, 70, 20))  contact_population_list <- create_contact_matrix(country = \"United Kingdom\", age.limits = age.limits) #> Warning in pop_age(survey.pop, part.age.group.present, ...): Not all age groups represented in population data (5-year age band). #>   Linearly estimating age group sizes from the 5-year bands.  parameters <- get_parameters(overrides = list(\"b0\" = 0.15,                                                \"b1\" = 0.25,                                                \"phi\" = 10),                              contact_population_list = contact_population_list)  # running the model model_simulation <- run_model(parameters = parameters,                                warm_up = 365 * 9,                                max_t = 365 * 10)  # adding noise to the incidence values and selecting samples every 5 days set.seed(123) df <- data.frame(time = model_simulation$time,                  incidence = as.integer(rnbinom(n = nrow(model_simulation), mu = model_simulation$Incidence, size = 50)),                  age_chr = model_simulation$age_chr) |>    subset(time %% 5 == 0)"},{"path":"https://isaacstopard.github.io/RSVsim/articles/Calibration.html","id":"likelihood-calculation","dir":"Articles","previous_headings":"","what":"Likelihood calculation","title":"Calibration","text":"R/get_calibration_parameters.R function can used obtain age groupings, times parameter values required dataset age-specific incidence data within list data frames. data frame must contain time (numeric), incidence (integer) age_chr (character) columns. age_chr age grouping. assume incidence, Ia,tI_{,t}, age group, aa, time, tt, Poisson distributed calculate log-likelihood R/calibration_likelihood.R function: Ia,t∼Poisson(λa,t)I_{,t} \\sim Poisson(\\lambda_{,t}), λa,t\\lambda_{,t} corresponding model simulated incidence. minimise argument specifies whether value multiplied -1, maximum likelihood can estimated using optimisation algorithm minimises value.","code":"data <- list(\"sim\" = df)  fixed_parameter_list <- get_calibration_parameters(data = data,                                                    data_populations = rep(parameters$total_population, length(data)),                                                    warm_up = 365 * 9) #> Warning in create_contact_matrix(country = country, age.limits = age.limits): #> polymod age groupings only go up to 75. Age limits above this have therefore #> been omitted. #> Warning in pop_age(survey.pop, part.age.group.present, ...): Not all age groups represented in population data (5-year age band). #>   Linearly estimating age group sizes from the 5-year bands.  calibration_likelihood(fitted_parameters = c(\"b0\" = 0.15, \"b1\" = 0.25, \"phi\" = 10),                        fixed_parameter_list = fixed_parameter_list,                        minimise = FALSE,                        data = data,                        cohort_step_size = 10,                        dt = 0.25) |> print() #> [1] -4601.531"},{"path":"https://isaacstopard.github.io/RSVsim/articles/Calibration.html","id":"maximum-likelihood-estimation","dir":"Articles","previous_headings":"","what":"Maximum likelihood estimation","title":"Calibration","text":"R/constrained_max_likelihood.R use nmlinb function https://github.com/SurajGupta/r-source/blob/master/src/library/stats/R/nlminb.R estimate parameters give maximum likelihood. can use fitted parameter values simulate transmission. ## Bayesian parameter estimation","code":"fitted_values <- constrained_max_likelihood(fixed_parameter_list = fixed_parameter_list,                                             data = data,                                             scale_parameters = list(lower = c(0.01, 0, 0), upper = c(10, 1, 365.25)),                                             cohort_step_size = 10,                                             dt = 0.25) #>   0:     357043.42: 0.250000 0.250000 0.250000 #>   1:     354149.03: 0.214626 0.225355 0.245967 #>   2:     343990.30: 0.139042 0.183648 0.239063 #>   3:     338092.57: 0.113180 0.174826 0.237410 #>   4:     314756.45: 0.0606985 0.159560 0.234226 #>   5:     297992.39: 0.0419267 0.155345 0.232960 #>   6:     293127.71: 0.0381650 0.154569 0.232616 #>   7:     233565.53: 0.00795722 0.148978 0.229805 #>   8:     131664.75: 0.0108954 0.148993 0.229784 #>   9:     109395.86: 0.0104682 0.232351 0.215408 #>  10:     106219.54: 0.0108181 0.232348 0.215393 #>  11:     105891.56: 0.0107493 0.232684 0.215322 #>  12:     105744.74: 0.0107044 0.232974 0.215131 #>  13:     105572.57: 0.0107551 0.233314 0.215060 #>  14:     105421.86: 0.0107138 0.233608 0.214875 #>  15:     105262.48: 0.0107614 0.233948 0.214805 #>  16:     105120.08: 0.0107226 0.234252 0.214635 #>  17:     104970.91: 0.0107677 0.234592 0.214565 #>  18:     104835.90: 0.0107311 0.234903 0.214407 #>  19:     104695.58: 0.0107740 0.235244 0.214338 #>  20:     104567.16: 0.0107394 0.235560 0.214191 #>  21:     104434.57: 0.0107804 0.235901 0.214122 #>  22:     104312.06: 0.0107475 0.236221 0.213985 #>  23:     104186.25: 0.0107867 0.236563 0.213916 #>  24:     104069.05: 0.0107554 0.236887 0.213787 #>  25:     103949.26: 0.0107931 0.237228 0.213718 #>  26:     103836.88: 0.0107632 0.237555 0.213596 #>  27:     103722.45: 0.0107994 0.237897 0.213528 #>  28:     103614.44: 0.0107708 0.238226 0.213413 #>  29:     103504.85: 0.0108058 0.238568 0.213345 #>  30:     103400.85: 0.0107783 0.238899 0.213235 #>  31:     103295.64: 0.0108122 0.239242 0.213168 #>  32:     103195.32: 0.0107856 0.239575 0.213062 #>  33:     103094.11: 0.0108185 0.239917 0.212996 #>  34:     102997.22: 0.0107929 0.240251 0.212895 #>  35:     102899.68: 0.0108249 0.240594 0.212829 #>  36:     102805.98: 0.0108001 0.240929 0.212731 #>  37:     102711.84: 0.0108313 0.241272 0.212666 #>  38:     102621.13: 0.0108072 0.241609 0.212572 #>  39:     102530.17: 0.0108377 0.241952 0.212507 #>  40:     102442.27: 0.0108142 0.242289 0.212416 #>  41:     102354.29: 0.0108441 0.242632 0.212352 #>  42:     102269.06: 0.0108212 0.242970 0.212264 #>  43:     102183.88: 0.0108505 0.243313 0.212200 #>  44:     102101.20: 0.0108281 0.243652 0.212114 #>  45:     102018.68: 0.0108569 0.243996 0.212051 #>  46:     101938.43: 0.0108350 0.244335 0.211968 #>  47:     101858.45: 0.0108633 0.244679 0.211905 #>  48:     101780.53: 0.0108418 0.245019 0.211824 #>  49:     101702.98: 0.0108697 0.245362 0.211761 #>  50:     101627.32: 0.0108486 0.245703 0.211683 #>  51:     101552.10: 0.0108761 0.246047 0.211621 #>  52:     101478.62: 0.0108554 0.246388 0.211544 #>  53:     101405.66: 0.0108825 0.246732 0.211482 #>  54:     101334.30: 0.0108621 0.247073 0.211407 #>  55:     101263.52: 0.0108889 0.247417 0.211346 #>  56:     101194.22: 0.0108689 0.247759 0.211273 #>  57:     101125.56: 0.0108953 0.248103 0.211213 #>  58:     101058.29: 0.0108755 0.248445 0.211141 #>  59:     100991.70: 0.0109017 0.248790 0.211081 #>  60:     100926.40: 0.0108822 0.249132 0.211010 #>  61:     100861.83: 0.0109081 0.249476 0.210951 #>  62:     100798.47: 0.0108889 0.249819 0.210882 #>  63:     100735.89: 0.0109145 0.250164 0.210823 #>  64:     100674.44: 0.0108955 0.250507 0.210756 #>  65:     100613.79: 0.0109210 0.250851 0.210698 #>  66:     100554.22: 0.0109021 0.251195 0.210631 #>  67:     100495.49: 0.0109274 0.251539 0.210574 #>  68:     100437.77: 0.0109088 0.251883 0.210508 #>  69:     100380.93: 0.0109338 0.252228 0.210451 #>  70:     100325.04: 0.0109154 0.252572 0.210387 #>  71:     100270.05: 0.0109401 0.252916 0.210331 #>  72:     100215.98: 0.0109219 0.253261 0.210268 #>  73:     100162.82: 0.0109465 0.253606 0.210212 #>  74:     100110.54: 0.0109285 0.253950 0.210151 #>  75:     100059.19: 0.0109529 0.254295 0.210095 #>  76:     100008.68: 0.0109351 0.254639 0.210035 #>  77:     99959.127: 0.0109593 0.254985 0.209980 #>  78:     99910.378: 0.0109416 0.255329 0.209920 #>  79:     99862.597: 0.0109657 0.255675 0.209866 #>  80:     99815.591: 0.0109482 0.256020 0.209808 #>  81:     99769.568: 0.0109721 0.256365 0.209754 #>  82:     99724.291: 0.0109547 0.256710 0.209697 #>  83:     99680.008: 0.0109785 0.257055 0.209644 #>  84:     99636.447: 0.0109613 0.257401 0.209587 #>  85:     99593.889: 0.0109849 0.257746 0.209535 #>  86:     99552.028: 0.0109678 0.258092 0.209479 #>  87:     99511.180: 0.0109913 0.258437 0.209427 #>  88:     99471.007: 0.0109743 0.258783 0.209373 #>  89:     99431.853: 0.0109976 0.259129 0.209322 #>  90:     99393.354: 0.0109809 0.259474 0.209268 #>  91:     99355.877: 0.0110040 0.259820 0.209217 #>  92:     99319.037: 0.0109874 0.260166 0.209164 #>  93:     99283.221: 0.0110104 0.260512 0.209114 #>  94:     99248.021: 0.0109939 0.260858 0.209062 #>  95:     99213.846: 0.0110168 0.261204 0.209013 #>  96:     99180.267: 0.0110004 0.261550 0.208961 #>  97:     99147.708: 0.0110231 0.261896 0.208913 #>  98:     99115.721: 0.0110069 0.262243 0.208862 #>  99:     99084.745: 0.0110295 0.262589 0.208814 #> 100:     99054.311: 0.0110133 0.262935 0.208764 #> 101:     99024.864: 0.0110359 0.263281 0.208716 #> 102:     98995.912: 0.0110198 0.263628 0.208667 #> 103:     98967.893: 0.0110422 0.263974 0.208620 #> 104:     98940.269: 0.0110263 0.264321 0.208571 #> 105:     98913.414: 0.0110486 0.264667 0.208525 #> 106:     98886.596: 0.0110328 0.265014 0.208476 #> 107:     98859.554: 0.0110549 0.265360 0.208428 #> 108:     98825.493: 0.0110393 0.265706 0.208374 #> 109:     98795.012: 0.0110548 0.265356 0.208378 #> 110:     98763.850: 0.0110328 0.265006 0.208379 #> 111:     98732.602: 0.0110547 0.265352 0.208329 #> 112:     98702.692: 0.0110390 0.265698 0.208276 #> 113:     98660.530: 0.0110547 0.265348 0.208272 #> 114:     98594.952: 0.0110327 0.265000 0.208244 #> 115:     98566.653: 0.0110547 0.265346 0.208198 #> 116:     98539.040: 0.0110389 0.265692 0.208146 #> 117:     98510.338: 0.0110612 0.266039 0.208099 #> 118:     98461.389: 0.0110455 0.266382 0.208030 #> 119:     98431.656: 0.0110611 0.266032 0.208037 #> 120:     98401.798: 0.0110390 0.265683 0.208037 #> 121:     98350.239: 0.0110612 0.266026 0.207973 #> 122:     98311.238: 0.0110453 0.266371 0.207911 #> 123:     98278.372: 0.0110612 0.266021 0.207917 #> 124:     98244.441: 0.0110389 0.265671 0.207912 #> 125:     98209.978: 0.0110612 0.266017 0.207863 #> 126:     98177.259: 0.0110451 0.266362 0.207804 #> 127:     98127.664: 0.0110612 0.266012 0.207798 #> 128:     93254.605: 0.0106839 0.225079 0.203267 #> 129:     86705.306: 0.0123176 0.254568 0.174562 #> 130:     34731.031: 0.0114812 0.284158 0.145928 #> 131:     16967.785: 0.0121887 0.313765 0.117307 #> 132:     15735.368: 0.0119042 0.313767 0.117289 #> 133:     15617.544: 0.0119656 0.313963 0.117091 #> 134:     9082.1692: 0.0123515 0.344375 0.0879054 #> 135:     8945.0187: 0.0127730 0.344372 0.0879133 #> 136:     8666.8233: 0.0126063 0.344253 0.0878630 #> 137:     8650.7435: 0.0125780 0.344050 0.0878122 #> 138:     7811.9143: 0.0129773 0.336346 0.0767472 #> 139:     5956.7875: 0.0136494 0.292638 0.0451190 #> 140:     5840.3550: 0.0137410 0.292635 0.0451240 #> 141:     5837.0355: 0.0137530 0.292559 0.0450744 #> 142:     5834.1290: 0.0137445 0.292476 0.0450353 #> 143:     5253.6401: 0.0142358 0.263340 0.0238995 #> 144:     5210.2102: 0.0141671 0.263338 0.0238999 #> 145:     5204.8923: 0.0141803 0.263272 0.0238873 #> 146:     5200.3375: 0.0141717 0.263224 0.0239357  print(fitted_values$par) #> [1] 0.1515754 0.2632237 8.7425274 parameters_fit <- get_parameters(overrides = list(\"b0\" = fitted_values$par[1],                                                    \"b1\" = fitted_values$par[2],                                                    \"phi\" = fitted_values$par[3]),                                  contact_population_list = contact_population_list)  model_simulation_fit <- run_model(parameters_fit,                                    warm_up = 365 * 9,                                    max_t = 365 * 10)  # visualising the simulated data and fitted model ggplot(data = df |>           dplyr::mutate(age_chr =                           factor(df$age_chr,                                  levels = c(\"[0,1)\", \"[1,2)\", \"[2,3)\", \"[3,4)\", \"[4,5)\", \"[5,10)\", \"[10,30)\", \"[30,50)\", \"[50,70)\", \"[70,90)\"))),         aes(x = time, y = incidence, col = age_chr)) +    geom_point() +    theme_classic() +   geom_line(data = model_simulation_fit, inherit.aes = FALSE,              aes(x = time, y = Incidence, group = age_chr, col = age_chr)             )"},{"path":"https://isaacstopard.github.io/RSVsim/articles/Introduction.html","id":"model-structure","dir":"Articles","previous_headings":"","what":"Model structure","title":"Introduction","text":"model adapted version susceptible-exposed-infectious-recovered-susceptible (SEIRS) deterministic, ordinary differential equation (ODE) model outlined : Hogan, . B., Campbell, P. T., Blyth, C. C., Lim, F. J., Fathima, P., Davis, S., … & Glass, K. (2017). Potential impact maternal vaccine RSV: mathematical modelling study. Vaccine, 35(45), 6172-6179, https://doi.org/10.1016/j.vaccine.2017.09.043, Nazareno, . L., Newall, . T., Muscatello, D. J., Hogan, . B., & Wood, J. G. (2024). Modelling epidemiological impact maternal respiratory syncytial virus (RSV) vaccination Australia. Vaccine, 42(26), 126418, https://doi.org/10.1016/j.vaccine.2024.126418. brief, model age-structured primary (first) secondary infections (subsequent infection) specifically tracked. age-specific force infection determined seasonal forcing function age-specific contact matrix (mean contacts per person).","code":""},{"path":"https://isaacstopard.github.io/RSVsim/articles/Introduction.html","id":"contact-matrix","dir":"Articles","previous_headings":"","what":"Contact matrix","title":"Introduction","text":"R/create_contact_matrix.R function obtains contact matrices age groupings less one year. , socialmixr (https://epiforecasts.io/socialmixr/) package used obtain contact matrix age groupings nearest whole year, using POLYMOD data (https://doi.org/10.1371/journal.pmed.0050074). contact matrix calculated total contacts population symmetric (assuming population data World Population Prospects United Nations). Within age groups less one year, contacts divided evenly according size age group (years). function takes two arguments: (1) country obtain POLYMOD contact data (2) lower age limits age groups.","code":"contact_population_list <- create_contact_matrix(country = \"United Kingdom\", age.limits = age.limits) #> Warning in create_contact_matrix(country = \"United Kingdom\", age.limits = age.limits): Not all age.limits are integers. #>             The contact matrix was calculated for the age groups given by the integers #>             and divided uniformly within the smaller age groups. #>             A warning from socialmixr about linearly estimating the integer age groups within the 5-year age bands will also appear. #> Warning in pop_age(survey.pop, part.age.group.present, ...): Not all age groups represented in population data (5-year age band). #>   Linearly estimating age group sizes from the 5-year bands.  matrix_mean_plot <- contact_population_list$matrix_mean |>    as.data.frame() |>    tibble::rownames_to_column(\"age_y\") |>    tidyr::pivot_longer(-age_y, names_to = \"age_x\", values_to = \"mean_contacts\")  ggplot(data = matrix_mean_plot,         aes(x = age_x, y = age_y, fill = mean_contacts)) +    geom_tile() +   xlab(\"Age\") + ylab(\"Age\") + theme_bw()"},{"path":"https://isaacstopard.github.io/RSVsim/articles/Introduction.html","id":"default-parameters","dir":"Articles","previous_headings":"","what":"Default parameters","title":"Introduction","text":"obtain list default parameters run model use R/get_parameters.R function. parameters can changed using overrides argument; example override b0 (transmission rate coefficient) value 0.15.","code":"parameters <- get_parameters(overrides = list(\"b0\" = 0.15),                               contact_population_list = contact_population_list,                              fitted = NULL)"},{"path":"https://isaacstopard.github.io/RSVsim/articles/Introduction.html","id":"running-the-model","dir":"Articles","previous_headings":"","what":"Running the model","title":"Introduction","text":"run model R/run_model.R function used. Cohort aging used age population. time, proportion cohort aged, proportion determined length time people aged (cohort_step_size) proportion total length time age group. initial conditions given, assumed one percent prevalence primary infection compartment everyone else susceptible primary infection. new borns assumed susceptible primary infection. , plot simulated number people susceptible infected, line type indicating whether infection primary secondary.  incidence, detected incidence prevalence also calculated. calculate detected incidence age-specific detection probabilities used, default parameters assume one age 2 years old tested.","code":"out <- run_model(parameters = parameters,                  max_t = 3650, # maximum time to run the model for                  cohort_step_size = 10, # time at which to age people                  dt = 0.5, # time step to get model outputs for                  init_conds = NULL,                  warm_up = 3650 - 365 * 3)  ggplot(data = out) +   geom_line(aes(x = time, y = Sp), linetype = 1) +   geom_line(aes(x = time, y = Ss), linetype = 2) +   geom_line(aes(x = time, y = Ip), col = \"skyblue\", linetype = 1) +   geom_line(aes(x = time, y = Is), col = \"skyblue\", linetype = 2) +   facet_wrap(~age_chr, scales = \"free_y\") + theme_bw() +   xlab(\"Days\") +   ylab(\"Number of susceptible (black) or infected (blue) people\") ggplot(data = out,         aes(x = time, y = DetIncidence)) +   geom_line() +   facet_wrap(~age_chr) + theme_bw() +   ylab(\"Detected incidence\") +   xlab(\"Days\") ggplot(data = out,         aes(x = time, y = prev)) +   geom_line() +   scale_y_continuous(labels = scales::percent) +   facet_wrap(~age_chr) + theme_bw() +   ylab(\"Prevalence\") +   xlab(\"Days\")"},{"path":"https://isaacstopard.github.io/RSVsim/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Isaac Stopard. Author, maintainer. Alexandra Hogan. Author.","code":""},{"path":"https://isaacstopard.github.io/RSVsim/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Stopard , Hogan (2025). RSVsim: RSV Transmission Model. R package version 0.0.0.9000, https://github.com/IsaacStopard/RSVsim.","code":"@Manual{,   title = {RSVsim: RSV Transmission Model},   author = {Isaac Stopard and Alexandra Hogan},   year = {2025},   note = {R package version 0.0.0.9000},   url = {https://github.com/IsaacStopard/RSVsim}, }"},{"path":"https://isaacstopard.github.io/RSVsim/index.html","id":"rsvsim","dir":"","previous_headings":"","what":"RSV Transmission Model","title":"RSV Transmission Model","text":"deterministic, ODE model Respiratory Synctial Virus (RSV) transmission. package constant development, change without notice. current model outputs yet fully tested.","code":""},{"path":"https://isaacstopard.github.io/RSVsim/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"RSV Transmission Model","text":"can install development version RSVsim GitHub :","code":"# install.packages(\"pak\") pak::pak(\"IsaacStopard/RSVsim\")"},{"path":"https://isaacstopard.github.io/RSVsim/reference/RSVsim-package.html","id":null,"dir":"Reference","previous_headings":"","what":"RSVsim: RSV Transmission Model — RSVsim-package","title":"RSVsim: RSV Transmission Model — RSVsim-package","text":"Deterministic, ODE model Respiratory Synctial Virus (RSV) transmission.","code":""},{"path":[]},{"path":"https://isaacstopard.github.io/RSVsim/reference/RSVsim-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"RSVsim: RSV Transmission Model — RSVsim-package","text":"Maintainer: Isaac Stopard isaacstopard@hotmail.co.uk (ORCID) Authors: Alexandra Hogan alexandra.hogan@unsw.edu.au","code":""},{"path":"https://isaacstopard.github.io/RSVsim/reference/RSVsim.html","id":null,"dir":"Reference","previous_headings":"","what":"RSVsim: A package for simulating Respiratory Synctial Virus (RSV) transmission. — RSVsim","title":"RSVsim: A package for simulating Respiratory Synctial Virus (RSV) transmission. — RSVsim","text":"RSVsim: package simulating Respiratory Synctial Virus (RSV) transmission.","code":""},{"path":"https://isaacstopard.github.io/RSVsim/reference/calibration_likelihood.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate the likelihood of observing incidence data given the model outputs — calibration_likelihood","title":"Calculate the likelihood of observing incidence data given the model outputs — calibration_likelihood","text":"Function run model calculate likelihood. poisson likelihood used incidence. parameters must constrained, b0 greater 0, b1 0 1 phi 0 365.25. incidence data must provided count.","code":""},{"path":"https://isaacstopard.github.io/RSVsim/reference/calibration_likelihood.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate the likelihood of observing incidence data given the model outputs — calibration_likelihood","text":"","code":"calibration_likelihood(   fitted_parameters,   fixed_parameter_list,   data,   minimise = FALSE,   scale_parameters = NULL,   ... )"},{"path":"https://isaacstopard.github.io/RSVsim/reference/calibration_likelihood.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate the likelihood of observing incidence data given the model outputs — calibration_likelihood","text":"fitted_parameters Vector parameters want fit. Names must include \"b0\", \"b1\" \"phi\". fixed_parameter_list List parameters fixed. data List data frames incidence data. data frames \"incidence\", \"time\" \"age_chr\" columns must included. incidence data frames \"value\" column needed contain incidence values. prevalence data frame \"sample\" column required number people tested \"positive\" column number people test positive. minimise Boolean operator indicating whether log-likelihood multiplied -1. useful trying estimate maximum likelihood optimisation algorithm estimates minimum. scale_parameters List lower upper boundaries fitted parameters. Default: NULL. NULL parameters transformed. list provided parameters log-likelihood calculated assuming fitted_parameters already scaled 0 1 given lower upper limits. ... Arguments passed run_model max_t Simulation maximum time. Default: 3650 days. cohort_step_size Time steps run model adjusting ages cohorts. Default: 10 days. dt Time steps run model . Default: 0.25 days. init_conds Initial conditions run model. List. Default: NULL. NULL: 1% RSV prevalence assumed people primary infection. people assumed susceptible primary infection. warm_up Length time-points exclude calculating likelihood. Default: NULL.","code":""},{"path":"https://isaacstopard.github.io/RSVsim/reference/calibration_likelihood.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate the likelihood of observing incidence data given the model outputs — calibration_likelihood","text":"Log-likelihood.","code":""},{"path":"https://isaacstopard.github.io/RSVsim/reference/constrained_max_likelihood.html","id":null,"dir":"Reference","previous_headings":"","what":"Constrained maximum-likelihood estimation of the b0, b1 and phi parameters from incidence data. — constrained_max_likelihood","title":"Constrained maximum-likelihood estimation of the b0, b1 and phi parameters from incidence data. — constrained_max_likelihood","text":"Helper function assess times ages data, return suitable parameters run model. Initial parameter values set 0.","code":""},{"path":"https://isaacstopard.github.io/RSVsim/reference/constrained_max_likelihood.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Constrained maximum-likelihood estimation of the b0, b1 and phi parameters from incidence data. — constrained_max_likelihood","text":"","code":"constrained_max_likelihood(   fixed_parameter_list,   data,   scale_parameters,   cohort_step_size,   dt )"},{"path":"https://isaacstopard.github.io/RSVsim/reference/constrained_max_likelihood.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Constrained maximum-likelihood estimation of the b0, b1 and phi parameters from incidence data. — constrained_max_likelihood","text":"fixed_parameter_list List parameters fixed. data List data frames incidence data. data frames \"incidence\", \"time\" \"age_chr\" columns must included. incidence data frames \"value\" column needed contain incidence values. prevalence data frame \"sample\" column required number people tested \"positive\" column number people test positive. scale_parameters List lower upper boundaries fitted parameters. Default: NULL. NULL parameters transformed. list provided parameters log-likelihood calculated assuming fitted_parameters already scaled 0 1 given lower upper limits.","code":""},{"path":"https://isaacstopard.github.io/RSVsim/reference/constrained_max_likelihood.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Constrained maximum-likelihood estimation of the b0, b1 and phi parameters from incidence data. — constrained_max_likelihood","text":"List fitted parameter values b0, b1 phi.","code":""},{"path":"https://isaacstopard.github.io/RSVsim/reference/create_contact_matrix.html","id":null,"dir":"Reference","previous_headings":"","what":"Create contact matrix for RSVsim — create_contact_matrix","title":"Create contact matrix for RSVsim — create_contact_matrix","text":"Uses socialmixr package access POLYMOD data calculate per-person mean contact matrix. age groupings smaller 1-year required, function calculates total contacts population nearest integer age groupings (required socialmixr package) splits total contacts smaller age groupings dividing uniformly.","code":""},{"path":"https://isaacstopard.github.io/RSVsim/reference/create_contact_matrix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create contact matrix for RSVsim — create_contact_matrix","text":"","code":"create_contact_matrix(   country = \"United Kingdom\",   age.limits = c(seq(0, 5, 1/12), seq(10, 70, 5)) )"},{"path":"https://isaacstopard.github.io/RSVsim/reference/create_contact_matrix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create contact matrix for RSVsim — create_contact_matrix","text":"country Country use contact_matrix function socialmixr package. Can given country name 2 digit ISO code. United Kingdom default. age.limits Lower limits age groups run simulation. Ages must years.","code":""},{"path":"https://isaacstopard.github.io/RSVsim/reference/create_contact_matrix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create contact matrix for RSVsim — create_contact_matrix","text":"List including contact matrix (matrix_mean mean per person, matrix_contacts total contacts), age limits, age distribution used calculate total contacts maximum age contact data.","code":""},{"path":"https://isaacstopard.github.io/RSVsim/reference/get_calibration_parameters.html","id":null,"dir":"Reference","previous_headings":"","what":"Get parameters for the calibration_likelihood function from the data — get_calibration_parameters","title":"Get parameters for the calibration_likelihood function from the data — get_calibration_parameters","text":"Helper function assess times ages data, return suitable parameters run model.","code":""},{"path":"https://isaacstopard.github.io/RSVsim/reference/get_calibration_parameters.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get parameters for the calibration_likelihood function from the data — get_calibration_parameters","text":"","code":"get_calibration_parameters(   data,   data_populations,   country = \"United Kingdom\",   warm_up = NULL )"},{"path":"https://isaacstopard.github.io/RSVsim/reference/get_calibration_parameters.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get parameters for the calibration_likelihood function from the data — get_calibration_parameters","text":"data List data frames incidence data. data frames \"incidence\", \"time\" \"age_chr\" columns must included. incidence data frames \"value\" column needed contain incidence values. prevalence data frame \"sample\" column required number people tested \"positive\" column number people test positive. data_populations Vector total population sizes dataframe data. country Country use contact_matrix function socialmixr package. Can given country name 2 digit ISO code. United Kingdom default. warm_up Length time-points exclude calculating likelihood. Default: NULL.","code":""},{"path":"https://isaacstopard.github.io/RSVsim/reference/get_calibration_parameters.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get parameters for the calibration_likelihood function from the data — get_calibration_parameters","text":"List fixed parameters, max_t warm_up.","code":""},{"path":"https://isaacstopard.github.io/RSVsim/reference/get_parameters.html","id":null,"dir":"Reference","previous_headings":"","what":"Get parameters for RSVsim — get_parameters","title":"Get parameters for RSVsim — get_parameters","text":"Provides default parameters run RSV model.","code":""},{"path":"https://isaacstopard.github.io/RSVsim/reference/get_parameters.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get parameters for RSVsim — get_parameters","text":"","code":"get_parameters(overrides = list(), contact_population_list, fitted = NULL)"},{"path":"https://isaacstopard.github.io/RSVsim/reference/get_parameters.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get parameters for RSVsim — get_parameters","text":"overrides List default parameters change. contact_population_list List outputs create_contact_matrix function. fitted Vector parameter names exclude list fitted. Default: NULL.","code":""},{"path":"https://isaacstopard.github.io/RSVsim/reference/get_parameters.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get parameters for RSVsim — get_parameters","text":"Parameter list.","code":""},{"path":"https://isaacstopard.github.io/RSVsim/reference/run_model.html","id":null,"dir":"Reference","previous_headings":"","what":"Runs the RSV model — run_model","title":"Runs the RSV model — run_model","text":"Function run transmission model cohort aging.","code":""},{"path":"https://isaacstopard.github.io/RSVsim/reference/run_model.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Runs the RSV model — run_model","text":"","code":"run_model(   parameters,   max_t = 3650,   cohort_step_size = 10,   dt = 0.25,   init_conds = NULL,   warm_up = NULL )"},{"path":"https://isaacstopard.github.io/RSVsim/reference/run_model.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Runs the RSV model — run_model","text":"parameters List parameters get_params function. max_t Simulation maximum time. Default: 3650 days. cohort_step_size Time steps run model adjusting ages cohorts. Default: 10 days. dt Time steps run model . Default: 0.25 days. init_conds Initial conditions run model. List. Default: NULL. NULL: 1% RSV prevalence assumed people primary infection. people assumed susceptible primary infection. warm_up Length time-points exclude calculating likelihood. Default: NULL.","code":""},{"path":"https://isaacstopard.github.io/RSVsim/reference/run_model.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Runs the RSV model — run_model","text":"Simulation output (dataframe). dataframe, age refers lowest age age group.","code":""}]
